/*
 * DRV2605LDefs.h
 *
 *  Created on: 9 feb. 2018
 *      Author: jmartin
 *
 *  Modified on: 22 mar. 2020
 *  	Author: Manuel Simal Perez <msimal@b105.upm.es>
 */

#ifndef BSP_HAPTICS_DRV2605L_DRV2605LDEFS_H_
#define BSP_HAPTICS_DRV2605L_DRV2605LDEFS_H_

#define DRV2605L_I2C_ADDRESS  (0x5A << 1)

#define DRV2605L_STATUS		0x0
#define DRV2605L_MODE		0x1
#define DRV2605L_RT_PB_IN	0x2
#define DRV2605L_LIB_SEL		0x3
#define DRV2605L_WV_SEQ_1	0x4
#define DRV2605L_WV_SEQ_2	0x5
#define DRV2605L_WV_SEQ_3	0x6
#define DRV2605L_WV_SEQ_4	0x7
#define DRV2605L_WV_SEQ_5	0x8
#define DRV2605L_WV_SEQ_6	0x9
#define DRV2605L_WV_SEQ_7	0xa
#define DRV2605L_WV_SEQ_8	0xb
#define DRV2605L_GO				0xc
#define DRV2605L_OVERDRIVE_OFF	0xd
#define DRV2605L_SUSTAIN_P_OFF	0xe
#define DRV2605L_SUSTAIN_N_OFF	0xf
#define DRV2605L_BRAKE_OFF		0x10
#define DRV2605L_A_TO_V_CTRL		0x11
#define DRV2605L_A_TO_V_MIN_INPUT	0x12
#define DRV2605L_A_TO_V_MAX_INPUT	0x13
#define DRV2605L_A_TO_V_MIN_OUT	0x14
#define DRV2605L_A_TO_V_MAX_OUT	0x15
#define DRV2605L_RATED_VOLT		0x16
#define DRV2605L_OD_CLAMP_VOLT	0x17
#define DRV2605L_CAL_COMP		0x18
#define DRV2605L_CAL_BACK_EMF	0x19
#define DRV2605L_FEEDBACK_CTRL	0x1a
#define DRV2605L_CTRL1			0x1b
#define DRV2605L_CTRL2			0x1c
#define DRV2605L_CTRL3			0x1d
#define DRV2605L_CTRL4			0x1e
#define DRV2605L_CTRL5			0x1f
#define DRV2605L_LRA_LOOP_PERIOD	0x20
#define DRV2605L_VBAT_MON		0x21
#define DRV2605L_LRA_RES_PERIOD	0x22
#define DRV2605L_MAX_REG			0x23

#define DRV2605L_GO_BIT				0x01

/* Library Selection */
#define DRV2605L_LIB_SEL_MASK		0x07
#define DRV2605L_LIB_SEL_RAM			0x0
#define DRV2605L_LIB_SEL_OD			0x1
#define DRV2605L_LIB_SEL_40_60		0x2
#define DRV2605L_LIB_SEL_60_80		0x3
#define DRV2605L_LIB_SEL_100_140		0x4
#define DRV2605L_LIB_SEL_140_PLUS	0x5

#define DRV2605L_LIB_SEL_HIZ_MASK	0x10
#define DRV2605L_LIB_SEL_HIZ_EN		0x01
#define DRV2605L_LIB_SEL_HIZ_DIS		0

/* Mode register */
#define DRV2605L_STANDBY				(1 << 6)
#define DRV2605L_STANDBY_MASK		0x40
#define DRV2605L_INTERNAL_TRIGGER	0x00
#define DRV2605L_EXT_TRIGGER_EDGE	0x01
#define DRV2605L_EXT_TRIGGER_LEVEL	0x02
#define DRV2605L_PWM_ANALOG_IN		0x03
#define DRV2605L_AUDIOHAPTIC			0x04
#define DRV2605L_RT_PLAYBACK			0x05
#define DRV2605L_DIAGNOSTICS			0x06
#define DRV2605L_AUTO_CAL			0x07

/* Audio to Haptics Control */
#define DRV2605L_AUDIO_HAPTICS_PEAK_10MS		(0 << 2)
#define DRV2605L_AUDIO_HAPTICS_PEAK_20MS		(1 << 2)
#define DRV2605L_AUDIO_HAPTICS_PEAK_30MS		(2 << 2)
#define DRV2605L_AUDIO_HAPTICS_PEAK_40MS		(3 << 2)

#define DRV2605L_AUDIO_HAPTICS_FILTER_100HZ	0x00
#define DRV2605L_AUDIO_HAPTICS_FILTER_125HZ	0x01
#define DRV2605L_AUDIO_HAPTICS_FILTER_150HZ	0x02
#define DRV2605L_AUDIO_HAPTICS_FILTER_200HZ	0x03

/* Min/Max Input/Output Voltages */
#define DRV2605L_AUDIO_HAPTICS_MIN_IN_VOLT	0x19
#define DRV2605L_AUDIO_HAPTICS_MAX_IN_VOLT	0x64
#define DRV2605L_AUDIO_HAPTICS_MIN_OUT_VOLT	0x19
#define DRV2605L_AUDIO_HAPTICS_MAX_OUT_VOLT	0xFF

/* Feedback register */
#define DRV2605L_FB_REG_ERM_MODE			0x7f
#define DRV2605L_FB_REG_LRA_MODE			(1 << 7)

#define DRV2605L_BRAKE_FACTOR_MASK	0x1f
#define DRV2605L_BRAKE_FACTOR_2X		(1 << 0)
#define DRV2605L_BRAKE_FACTOR_3X		(2 << 4)
#define DRV2605L_BRAKE_FACTOR_4X		(3 << 4)
#define DRV2605L_BRAKE_FACTOR_6X		(4 << 4)
#define DRV2605L_BRAKE_FACTOR_8X		(5 << 4)
#define DRV2605L_BRAKE_FACTOR_16		(6 << 4)
#define DRV2605L_BRAKE_FACTOR_DIS	(7 << 4)

#define DRV2605L_LOOP_GAIN_LOW		0xf3
#define DRV2605L_LOOP_GAIN_MED		(1 << 2)
#define DRV2605L_LOOP_GAIN_HIGH		(2 << 2)
#define DRV2605L_LOOP_GAIN_VERY_HIGH	(3 << 2)

#define DRV2605L_BEMF_GAIN_0			0xfc
#define DRV2605L_BEMF_GAIN_1		(1 << 0)
#define DRV2605L_BEMF_GAIN_2		(2 << 0)
#define DRV2605L_BEMF_GAIN_3		(3 << 0)

/* Control 1 register */
#define DRV2605L_AC_CPLE_EN			(1 << 5)
#define DRV2605L_STARTUP_BOOST		(1 << 7)

/* Control 2 register */

#define DRV2605L_IDISS_TIME_45		0
#define DRV2605L_IDISS_TIME_75		(1 << 0)
#define DRV2605L_IDISS_TIME_150		(1 << 1)
#define DRV2605L_IDISS_TIME_225		0x03

#define DRV2605L_BLANK_TIME_45	(0 << 2)
#define DRV2605L_BLANK_TIME_75	(1 << 2)
#define DRV2605L_BLANK_TIME_150	(2 << 2)
#define DRV2605L_BLANK_TIME_225	(3 << 2)

#define DRV2605L_SAMP_TIME_150	(0 << 4)
#define DRV2605L_SAMP_TIME_200	(1 << 4)
#define DRV2605L_SAMP_TIME_250	(2 << 4)
#define DRV2605L_SAMP_TIME_300	(3 << 4)

#define DRV2605L_BRAKE_STABILIZER	(1 << 6)
#define DRV2605L_UNIDIR_IN			(0 << 7)
#define DRV2605L_BIDIR_IN			(1 << 7)

/* Control 3 Register */
#define DRV2605L_LRA_OPEN_LOOP		(1 << 0)
#define DRV2605L_ANANLOG_IN			(1 << 1)
#define DRV2605L_LRA_DRV_MODE		(1 << 2)
#define DRV2605L_RTP_UNSIGNED_DATA	(1 << 3)
#define DRV2605L_SUPPLY_COMP_DIS		(1 << 4)
#define DRV2605L_ERM_OPEN_LOOP		(1 << 5)
#define DRV2605L_NG_THRESH_0			(0 << 6)
#define DRV2605L_NG_THRESH_2			(1 << 6)
#define DRV2605L_NG_THRESH_4			(2 << 6)
#define DRV2605L_NG_THRESH_8			(3 << 6)

/* Control 4 Register */
#define DRV2605L_AUTOCAL_TIME_150MS		(0 << 4)
#define DRV2605L_AUTOCAL_TIME_250MS		(1 << 4)
#define DRV2605L_AUTOCAL_TIME_500MS		(2 << 4)
#define DRV2605L_AUTOCAL_TIME_1000MS		(3 << 4)


#endif /* BSP_HAPTICS_DRV2605L_DRV2605LDEFS_H_ */
